syntax = "proto3";

package elixir_cqrs;

import "google/protobuf/empty.proto";
import "common.proto";

// カテゴリコマンドサービス
service CategoryCommandService {
  rpc CreateCategory(CreateCategoryRequest) returns (CreateCategoryResponse);
  rpc UpdateCategory(UpdateCategoryRequest) returns (UpdateCategoryResponse);
  rpc DeleteCategory(DeleteCategoryRequest) returns (DeleteCategoryResponse);
}

// 商品コマンドサービス
service ProductCommandService {
  rpc CreateProduct(CreateProductRequest) returns (CreateProductResponse);
  rpc UpdateProduct(UpdateProductRequest) returns (UpdateProductResponse);
  rpc DeleteProduct(DeleteProductRequest) returns (DeleteProductResponse);
  rpc UpdateStock(UpdateStockRequest) returns (UpdateStockResponse);
  rpc ReserveStock(ReserveStockRequest) returns (ReserveStockResponse);
  rpc ReleaseStock(ReleaseStockRequest) returns (ReleaseStockResponse);
}

// カテゴリ作成リクエスト
message CreateCategoryRequest {
  string name = 1;
  string description = 2;
  string parent_id = 3;
  Metadata metadata = 4;
}

// カテゴリ作成レスポンス
message CreateCategoryResponse {
  string id = 1;
  Category category = 2;
}

// カテゴリ更新リクエスト
message UpdateCategoryRequest {
  string id = 1;
  string name = 2;
  string description = 3;
  string parent_id = 4;
  Metadata metadata = 5;
}

// カテゴリ更新レスポンス
message UpdateCategoryResponse {
  Category category = 1;
}

// カテゴリ削除リクエスト
message DeleteCategoryRequest {
  string id = 1;
  Metadata metadata = 2;
}

// カテゴリ削除レスポンス
message DeleteCategoryResponse {
  bool success = 1;
}

// 商品作成リクエスト
message CreateProductRequest {
  string name = 1;
  string description = 2;
  string category_id = 3;
  Money price = 4;
  int32 initial_stock = 5;
  Metadata metadata = 6;
}

// 商品作成レスポンス
message CreateProductResponse {
  string id = 1;
  Product product = 2;
}

// 商品更新リクエスト
message UpdateProductRequest {
  string id = 1;
  string name = 2;
  string description = 3;
  string category_id = 4;
  Money price = 5;
  Metadata metadata = 6;
}

// 商品更新レスポンス
message UpdateProductResponse {
  Product product = 1;
}

// 商品削除リクエスト
message DeleteProductRequest {
  string id = 1;
  Metadata metadata = 2;
}

// 商品削除レスポンス
message DeleteProductResponse {
  bool success = 1;
}

// 在庫更新リクエスト
message UpdateStockRequest {
  string product_id = 1;
  int32 quantity = 2;
  Metadata metadata = 3;
}

// 在庫更新レスポンス
message UpdateStockResponse {
  int32 current_stock = 1;
}

// 在庫予約リクエスト
message ReserveStockRequest {
  string product_id = 1;
  int32 quantity = 2;
  string reservation_id = 3;
  Metadata metadata = 4;
}

// 在庫予約レスポンス
message ReserveStockResponse {
  bool success = 1;
  int32 remaining_stock = 2;
}

// 在庫解放リクエスト
message ReleaseStockRequest {
  string product_id = 1;
  int32 quantity = 2;
  string reservation_id = 3;
  Metadata metadata = 4;
}

// 在庫解放レスポンス
message ReleaseStockResponse {
  bool success = 1;
  int32 current_stock = 2;
}