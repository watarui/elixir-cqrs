syntax = "proto3";

package elixir_cqrs;

import "common.proto";

// カテゴリクエリサービス
service CategoryQueryService {
  rpc GetCategory(GetCategoryRequest) returns (GetCategoryResponse);
  rpc ListCategories(ListCategoriesRequest) returns (ListCategoriesResponse);
  rpc SearchCategories(SearchCategoriesRequest) returns (SearchCategoriesResponse);
}

// 商品クエリサービス
service ProductQueryService {
  rpc GetProduct(GetProductRequest) returns (GetProductResponse);
  rpc ListProducts(ListProductsRequest) returns (ListProductsResponse);
  rpc SearchProducts(SearchProductsRequest) returns (SearchProductsResponse);
  rpc GetProductsByCategory(GetProductsByCategoryRequest) returns (GetProductsByCategoryResponse);
}

// カテゴリ取得リクエスト
message GetCategoryRequest {
  string id = 1;
}

// カテゴリ取得レスポンス
message GetCategoryResponse {
  Category category = 1;
}

// カテゴリ一覧リクエスト
message ListCategoriesRequest {
  Pagination pagination = 1;
  bool active_only = 2;
  string parent_id = 3;
}

// カテゴリ一覧レスポンス
message ListCategoriesResponse {
  repeated Category categories = 1;
  int32 total_count = 2;
}

// カテゴリ検索リクエスト
message SearchCategoriesRequest {
  string keyword = 1;
  Pagination pagination = 2;
}

// カテゴリ検索レスポンス
message SearchCategoriesResponse {
  repeated Category categories = 1;
  int32 total_count = 2;
}

// 商品取得リクエスト
message GetProductRequest {
  string id = 1;
}

// 商品取得レスポンス
message GetProductResponse {
  Product product = 1;
}

// 商品一覧リクエスト
message ListProductsRequest {
  Pagination pagination = 1;
  bool active_only = 2;
  string category_id = 3;
}

// 商品一覧レスポンス
message ListProductsResponse {
  repeated Product products = 1;
  int32 total_count = 2;
}

// 商品検索リクエスト
message SearchProductsRequest {
  string search_term = 1;
  Pagination pagination = 2;
  string category_id = 3;
  Money min_price = 4;
  Money max_price = 5;
}

// 商品検索レスポンス
message SearchProductsResponse {
  repeated Product products = 1;
  int32 total_count = 2;
}

// カテゴリ別商品取得リクエスト
message GetProductsByCategoryRequest {
  string category_id = 1;
  Pagination pagination = 2;
  bool active_only = 3;
}

// カテゴリ別商品取得レスポンス
message GetProductsByCategoryResponse {
  repeated Product products = 1;
  int32 total_count = 2;
  Category category = 3;
}