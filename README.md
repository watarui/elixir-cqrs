# Elixir CQRS Event-Driven Microservices

Elixir/Phoenix ã‚’ä½¿ç”¨ã—ãŸæœ¬æ ¼çš„ãª CQRSï¼ˆCommand Query Responsibility Segregationï¼‰+ ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚° + ã‚µã‚¬ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿè£…ä¾‹ã§ã™ã€‚

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ãƒ¢ãƒ€ãƒ³ãªãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å®Ÿè£…ã—ãŸã€å®Ÿè·µçš„ãª E ã‚³ãƒãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã™ã€‚

### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

- **Client Service** (GraphQL API Gateway) - ãƒãƒ¼ãƒˆ 4000
- **Command Service** (æ›¸ãè¾¼ã¿å°‚ç”¨ gRPC) - ãƒãƒ¼ãƒˆ 50051
- **Query Service** (èª­ã¿å–ã‚Šå°‚ç”¨ gRPC) - ãƒãƒ¼ãƒˆ 50052
- **PostgreSQL** (Event Store + Read Models) - ãƒãƒ¼ãƒˆ 5432-5434
- **ç›£è¦–ã‚¹ã‚¿ãƒƒã‚¯** (Prometheus, Grafana, Jaeger)

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend Applications                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ GraphQL
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Client Service  â”‚
                    â”‚  (API Gateway)  â”‚
                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                        â”‚         â”‚ gRPC
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚Command Service â”‚   â”‚ Query Service    â”‚
         â”‚   (Write)      â”‚   â”‚   (Read)         â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                      â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Event Store       â”‚  â”‚  Read Models    â”‚
     â”‚   (PostgreSQL)      â”‚  â”‚  (PostgreSQL)   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CQRS + Event Sourcing ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
Write Side (Command)                    Read Side (Query)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GraphQL Mutation  â”‚                â”‚   GraphQL Query     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚   Command   â”‚                        â”‚    Query    â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚  Aggregate  â”‚                        â”‚ Read Model  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚   Domain    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Event   â”‚â”€â–¶â”‚ Projection  â”‚
    â”‚   Event     â”‚         â”‚  Store   â”‚  â”‚  Manager    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚µã‚¬ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆåˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼‰

```
Order Saga Flow:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Create Order â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”     Success      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Reserveâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚Process       â”‚
   â”‚Stock  â”‚                  â”‚Payment       â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Fail                        â”‚ Success
       â”‚                             â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Compensate â”‚              â”‚Arrange       â”‚
   â”‚(Cancel)   â”‚              â”‚Shipping      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚Confirm Order â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Quick Start

### Docker Compose ã«ã‚ˆã‚‹èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰

```bash
# é–‹ç™ºç’°å¢ƒã®èµ·å‹•
docker compose up -d

# ç›£è¦–ã‚¹ã‚¿ãƒƒã‚¯ã‚‚å«ã‚ã¦èµ·å‹•
docker compose -f docker-compose.yml -f docker-compose.monitoring.yml up -d

# ãƒ­ã‚°ã®ç¢ºèª
docker compose logs -f
```

### æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### å‰ææ¡ä»¶

- Elixir 1.18+
- PostgreSQL 14+
- protoc (Protocol Buffers ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©)
- protoc-gen-elixir

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ
createdb command_service_dev
createdb query_service_dev
createdb event_store_dev

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
cd apps/command_service && mix ecto.migrate
cd apps/query_service && mix ecto.migrate
cd apps/shared && MIX_ENV=dev mix ecto.migrate -r Shared.Infrastructure.EventStore.Repo
```

#### ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•

```bash
# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
mix deps.get

# å„ã‚µãƒ¼ãƒ“ã‚¹ã‚’å€‹åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§èµ·å‹•
# Terminal 1: Query Service
cd apps/query_service && mix run --no-halt

# Terminal 2: Command Service
cd apps/command_service && mix run --no-halt

# Terminal 3: Client Service
cd apps/client_service && mix phx.server
```

## ğŸ“¡ API ä½¿ç”¨ä¾‹

### GraphQL Playground

é–‹ç™ºç’°å¢ƒã§ã¯ã€GraphQL Playground ãŒåˆ©ç”¨å¯èƒ½ã§ã™ï¼š

- URL: http://localhost:4000/graphiql

### åŸºæœ¬çš„ãª CRUD æ“ä½œ

#### ã‚«ãƒ†ã‚´ãƒªä½œæˆ

```graphql
mutation {
  createCategory(input: { name: "Electronics" }) {
    id
    name
  }
}
```

#### å•†å“ä½œæˆ

```graphql
mutation {
  createProduct(
    input: { name: "MacBook Pro", price: 299000, categoryId: "1" }
  ) {
    id
    name
    price
    category {
      name
    }
  }
}
```

#### å•†å“ä¸€è¦§å–å¾—

```graphql
query {
  products {
    id
    name
    price
    category {
      id
      name
    }
  }
}
```

### æ³¨æ–‡å‡¦ç†ï¼ˆã‚µã‚¬ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰

```graphql
mutation {
  createOrder(
    input: { userId: "user-123", items: [{ productId: "1", quantity: 1 }] }
  ) {
    id
    status
    totalAmount
    sagaState {
      state
      status
      currentStep
      startedAt
      completedAt
    }
    items {
      productId
      productName
      quantity
      price
      subtotal
    }
  }
}
```

## ğŸ” ä¸»è¦æ©Ÿèƒ½

### âœ… å®Ÿè£…æ¸ˆã¿

#### ã‚³ã‚¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

- **CQRSï¼ˆCommand Query Responsibility Segregationï¼‰**

  - ã‚³ãƒãƒ³ãƒ‰ãƒã‚¹ï¼ˆãƒ¡ãƒ‡ã‚£ã‚¨ãƒ¼ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
  - ã‚¯ã‚¨ãƒªãƒã‚¹ï¼ˆä¸¦åˆ—å®Ÿè¡Œã‚µãƒãƒ¼ãƒˆï¼‰
  - çµ±ä¸€ CQRS ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰

- **ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°**

  - ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆã‚¢ï¼ˆPostgreSQL å®Ÿè£…ï¼‰
  - ã‚¢ã‚°ãƒªã‚²ãƒ¼ãƒˆåŸºåº•ã‚¯ãƒ©ã‚¹
  - ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è‡ªå‹•æ›´æ–°

- **ã‚µã‚¬ãƒ‘ã‚¿ãƒ¼ãƒ³**
  - åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
  - è£œå„Ÿãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆè¨­è¨ˆæ¸ˆã¿ï¼‰
  - ã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç†
  - ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†

#### ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£

- **ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹é–“é€šä¿¡**

  - gRPCï¼ˆProtocol Buffersï¼‰
  - GraphQL API Gateway
  - éåŒæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°

- **ãƒ¬ã‚¸ãƒªã‚¨ãƒ³ã‚¹**

  - ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼
  - ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹ï¼ˆã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰
  - ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç®¡ç†
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€

- **ç›£è¦–ãƒ»å¯è¦³æ¸¬æ€§**
  - OpenTelemetry çµ±åˆ
  - åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ï¼ˆJaegerï¼‰
  - ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ï¼ˆPrometheusï¼‰
  - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆGrafanaï¼‰
  - æ§‹é€ åŒ–ãƒ­ã‚°

#### ãƒ‡ãƒ¼ã‚¿ç®¡ç†

- **ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³**

  - Unit of Work
  - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
  - ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥

- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
  - BatchCacheï¼ˆN+1 å•é¡Œè§£æ±ºï¼‰
  - ETS ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥
  - GraphQL DataLoader çµ±åˆ

### ğŸš§ å®Ÿè£…äºˆå®š

- èªè¨¼ãƒ»èªå¯ï¼ˆJWT/OAuth2ï¼‰
- GraphQL Subscriptionsï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ï¼‰
- ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°
- ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæ©Ÿèƒ½
- ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
elixir-cqrs/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ client_service/         # GraphQL API Gateway
â”‚   â”‚   â”œâ”€â”€ graphql/           # GraphQLã‚¹ã‚­ãƒ¼ãƒãƒ»ãƒªã‚¾ãƒ«ãƒãƒ¼
â”‚   â”‚   â”œâ”€â”€ application/       # CQRSãƒ•ã‚¡ã‚µãƒ¼ãƒ‰
â”‚   â”‚   â””â”€â”€ infrastructure/    # gRPCæ¥ç¶šç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ command_service/        # æ›¸ãè¾¼ã¿å°‚ç”¨ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚   â”œâ”€â”€ domain/            # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ aggregates/    # ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã‚¢ã‚°ãƒªã‚²ãƒ¼ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ commands/      # ã‚³ãƒãƒ³ãƒ‰å®šç¾©
â”‚   â”‚   â”‚   â””â”€â”€ events/        # ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ application/       # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ handlers/      # ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
â”‚   â”‚   â”‚   â””â”€â”€ command_bus.ex # ã‚³ãƒãƒ³ãƒ‰ãƒã‚¹
â”‚   â”‚   â””â”€â”€ infrastructure/    # ã‚¤ãƒ³ãƒ•ãƒ©å±¤
â”‚   â”‚
â”‚   â”œâ”€â”€ query_service/          # èª­ã¿å–ã‚Šå°‚ç”¨ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚   â”œâ”€â”€ domain/            # èª­ã¿å–ã‚Šãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”œâ”€â”€ application/       # ã‚¯ã‚¨ãƒªãƒãƒ³ãƒ‰ãƒ©ãƒ¼
â”‚   â”‚   â””â”€â”€ infrastructure/    # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ãƒªãƒã‚¸ãƒˆãƒª
â”‚   â”‚
â”‚   â””â”€â”€ shared/                 # å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”‚       â”œâ”€â”€ domain/            # å…±é€šãƒ‰ãƒ¡ã‚¤ãƒ³å®šç¾©
â”‚       â”œâ”€â”€ infrastructure/    # å…±é€šã‚¤ãƒ³ãƒ•ãƒ©
â”‚       â”‚   â”œâ”€â”€ event_store/   # ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆã‚¢
â”‚       â”‚   â”œâ”€â”€ saga/          # ã‚µã‚¬ãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…
â”‚       â”‚   â””â”€â”€ telemetry/     # ç›£è¦–ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹
â”‚       â””â”€â”€ proto/             # Protocol Bufferså®šç¾©
â”‚
â”œâ”€â”€ docker/                     # Dockerè¨­å®š
â”œâ”€â”€ k8s/                       # Kubernetes ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
â””â”€â”€ docs/                      # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### è¨€èªãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

- **Elixir** 1.18 - é«˜ã„ä¸¦è¡Œæ€§ã¨è€éšœå®³æ€§
- **Phoenix** 1.7 - Web ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Absinthe** - GraphQL å®Ÿè£…
- **grpc-elixir** - gRPC é€šä¿¡

### ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢

- **PostgreSQL** 14 - ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆã‚¢ã€èª­ã¿å–ã‚Šãƒ¢ãƒ‡ãƒ«
- **ETS** - ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥

### ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ç›£è¦–

- **Docker** & **Docker Compose** - ã‚³ãƒ³ãƒ†ãƒŠåŒ–
- **Kubernetes** - ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆæº–å‚™æ¸ˆã¿ï¼‰
- **OpenTelemetry** - åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°
- **Prometheus** - ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†
- **Grafana** - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- **Jaeger** - åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹å¯è¦–åŒ–

## ğŸ“Š ç›£è¦–ãƒ»é‹ç”¨

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

- Client Service: http://localhost:4000/metrics
- Command Service: http://localhost:9569/metrics
- Query Service: http://localhost:9570/metrics

### ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

- Prometheus: http://localhost:9090
- Grafana: http://localhost:3000 (admin/admin)
- Jaeger: http://localhost:16686

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

```bash
# å…¨ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
mix test

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆä»˜ã
mix test --cover

# ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ†ã‚¹ãƒˆ
cd apps/command_service && mix test
```

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸](docs/architecture.md)
- [API ä»•æ§˜æ›¸](docs/api-specification.md)
- [ã‚µã‚¬ãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…ã‚¬ã‚¤ãƒ‰](docs/saga-pattern.md)
- [ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](docs/event-sourcing.md)
- [é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«](docs/operations.md)
